<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex, nofollow" />
    <title>*** Birthday Challenge Zone ***</title>
    <link rel="icon" type="image/png" href="images/favicon.jpg" />
    <link rel="stylesheet" href="css/geocities.css" />

    <!-- Firebase SDK -->
    <script
      src="https://www.gstatic.com/firebasejs/10.7.2/firebase-app-compat.js"
      type="module"
    ></script>
    <script
      src="https://www.gstatic.com/firebasejs/10.7.2/firebase-auth-compat.js"
      type="module"
    ></script>
  </head>

  <body>
    <main class="main-center">
      <section class="login-section">
        <div class="login-container">
          <h1 class="rainbow-text">
            WELCOME TO THE PARTY! <span id="secretArnold" class="secret-arnold">RICHTER</span>
          </h1>

          <!-- Login form with Firebase phone auth -->
          <form id="loginForm">
            <fieldset>
              <legend>Sign In</legend>
              <!-- Phone Input Step -->
              <div id="phoneStep" class="form-group">
                <label for="phoneInput">
                  <img
                    src="images/phone.gif"
                    alt="Phone Icon"
                    class="icon-gif icon-gif--with-text phone-label"
                  />
                  ENTER YOUR PHONE NUMBER
                </label>
                <input
                  type="tel"
                  inputmode="numeric"
                  id="phoneInput"
                  name="phone"
                  placeholder="(959) 867-5309"
                  maxlength="14"
                  required
                  autocomplete="tel"
                  class="phone-input"
                />
                <p class="input-help">10-digit US phone number</p>
                <div id="recaptchaContainer" class="recaptcha-container"></div>
                <button type="button" id="sendOTPBtn">>>> SEND CODE <<<</button>
              </div>

              <!-- OTP Input Step -->
              <div id="otpStep" class="form-group" style="display: none">
                <label for="otpInput">‚úîÔ∏è ENTER THE CODE FROM YOUR TEXT</label>
                <input
                  type="text"
                  id="otpInput"
                  name="otp"
                  placeholder="000000"
                  maxlength="6"
                  required
                  autocomplete="one-time-code"
                />
                <p class="input-help">Check your SMS for a 6-digit code</p>
                <button type="submit" id="verifyOTPBtn">>>> VERIFY CODE <<<</button>
                <button type="button" id="backBtn">‚Üê BACK</button>
              </div>

              <div id="error" class="error"></div>
            </fieldset>
          </form>
        </div>
      </section>
    </main>
    <script type="module">
      import { LoginPage } from "./js/pages/login.js";
      (async () => {
        try {
          console.log("üöÄ Starting login initialization...");
          const page = new LoginPage();
          await page.init();
          console.log("‚úÖ Login fully initialized");
        } catch (err) {
          console.error("‚ùå Login initialization failed:", err);
        }
      })();
    </script>
    <!-- Arnold Easter Egg-->
    <!-- Arnold Modal (hidden in DOM; shown on click) -->
    <div
      id="arnoldModal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      "
    >
      <div
        style="
          background: #fff;
          padding: 2rem;
          border-radius: 12px;
          text-align: center;
          box-shadow: 0 0 24px #000;
          max-width: 90%;
          max-height: 90%;
          overflow: auto;
        "
      >
        <h2>Winner! Winner! Winner!</h2>
        <p>
          You found the secret Arnold easter egg.<br />
          Don't worry it's not a tumor<br />
          Get to the chopper and I'll be back with your prize!
        </p>
        <a
          href="#"
          id="rickRoll"
          style="
            display: inline-block;
            margin-top: 1rem;
            padding: 0.5rem 1.5rem;
            background: #ff0000;
            color: #fff;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
          "
          >Claim Prize</a
        >
        <img
          id="arnoldGif"
          src="images/rick-roll.gif"
          alt="Arnold GIF"
          style="max-width: 100%; height: auto; display: none; margin: 0.5rem auto"
        />
        <audio id="arnoldAudio" src="songs/rickroll.mp3" preload="auto"></audio>
        <div style="margin-top: 1rem">
          <button id="close-arnold" style="padding: 0.5rem 1rem">Close</button>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const arnold = document.getElementById("secretArnold");
        const modal = document.getElementById("arnoldModal");
        const audio = document.getElementById("arnoldAudio");
        const closeBtn = document.getElementById("close-arnold");
        if (!arnold || !modal) return;

        arnold.addEventListener("click", () => {
          modal.style.display = "flex";
        });

        // Wire the in-modal Claim Prize (rickRoll) to show the gif and play audio
        const rick = document.getElementById("rickRoll");
        const gif = document.getElementById("arnoldGif");
        if (rick) {
          rick.addEventListener("click", (e) => {
            e.preventDefault();
            // Reveal the GIF
            if (gif) gif.style.display = "block";
            // Play audio
            if (audio && audio.play) {
              audio.currentTime = 0;
              audio.play().catch((err) => console.warn("Audio play prevented:", err));
            }
          });
        }

        const hideModal = () => {
          if (audio && audio.pause) {
            audio.pause();
            audio.currentTime = 0;
          }
          // Hide the gif if it's visible
          const gifEl = document.getElementById("arnoldGif");
          if (gifEl) {
            gifEl.style.display = "none";
          }
          modal.style.display = "none";
        };

        closeBtn?.addEventListener("click", hideModal);
        modal.addEventListener("click", (e) => {
          if (e.target === modal) hideModal();
        });
      });
    </script>
  </body>
</html>
